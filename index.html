<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover" />
<title>BOND HEAVY DUTY ‚Äî —Å–∏–ª–æ–≤—ã–µ –¥–Ω–∏ (PWA)</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f1216">

<style>
  /* ===== –ë–ê–ó–ê / iOS SAFE AREAS ===== */
  :root{
    --bg:#0f1216;--panel:#161a20;--ink:#e8edf3;--muted:#9aa7b3;
    --accent:#2dd4bf;--accent2:#60a5fa;--ok:#22c55e;--warn:#f59e0b;--danger:#ef4444;--line:#263242;
    --s-top: env(safe-area-inset-top);--s-right: env(safe-area-inset-right);
    --s-bottom: env(safe-area-inset-bottom);--s-left: env(safe-area-inset-left);
  }
  *{box-sizing:border-box}
  html{height:100%;-webkit-text-size-adjust:100%}
  body{
    min-height:100dvh; margin:0; overflow-x:hidden; /* –∂–µ—Å—Ç–∫–æ –∑–∞–ø—Ä–µ—â–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
    background:linear-gradient(180deg,#0d1117,#0f1319 45%,#10151b);
    color:var(--ink); font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
    padding-left:var(--s-left); padding-right:var(--s-right);
  }

  /* ===== –®–ê–ü–ö–ê ===== */
  header.topbar{
    position:sticky; top:0; z-index:10;
    background:rgba(15,18,22,.92); backdrop-filter:saturate(140%) blur(8px);
    border-bottom:1px solid var(--line); padding-top:var(--s-top);
  }
  .wrap{max-width:1100px;margin:0 auto;padding:14px 18px}
  h1{font-size:22px;margin:0 0 6px 0}
  .sub{color:var(--muted);font-size:14px}
  .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px}
  .toolbar > *{
    background:var(--panel);border:1px solid var(--line);color:var(--ink);
    padding:10px 12px;border-radius:12px;min-height:44px
  }
  input[type="date"]{background:transparent;border:none;color:var(--ink);font-size:16px}
  .btn{cursor:pointer;user-select:none;touch-action:manipulation}
  .btn:hover{border-color:var(--accent2)}
  .btn.ok{border-color:var(--ok);color:#d1fae5}
  .btn.warn{border-color:var(--warn);color:#fff7ed}
  .btn.danger{border-color:var(--danger);color:#fee2e2}

  /* ===== –¢–ê–ë–´ ===== */
  .tabs{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .tab{
    padding:10px 14px;border-radius:999px;border:1px solid var(--line);
    background:var(--panel);cursor:pointer;color:var(--ink);min-height:40px
  }
  .tab.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(45,212,191,.12) inset}

  /* ===== –ö–û–ù–¢–ï–ù–¢ ===== */
  main{max-width:1100px;margin:14px auto;padding:0 18px}
  .day{display:none}.day.active{display:block}

  .block{background:var(--panel);border:1px solid var(--line);border-radius:16px;margin:18px 0;overflow:hidden}
  .block > header{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:#12161c;border-bottom:1px solid var(--line)}
  .muted{color:var(--muted)}
  .tag{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--line);color:#cfe9ff;background:#0d1726}
  .oktag{border-color:var(--ok);background:#0d1a13;color:#bff7cf}

  .exercises{padding:10px}
  .panel{border:1px dashed var(--line);border-radius:14px;padding:10px;margin:10px 0;background:#0f141b}
  .ex-title{font-weight:700;margin:0 0 10px 0;display:flex;align-items:center;gap:8px;flex-wrap:wrap}
  .ex-title small{color:var(--muted);font-weight:500}

  /* ===== –ì–†–ò–î–´ –°–ï–¢–û–í (–±–µ–∑ —Ç–∞–±–ª–∏—Ü, –±–µ–∑ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞) ===== */
  .legend, .set-row{
    display:grid; align-items:center; gap:8px;
    grid-template-columns:
      auto
      clamp(76px, 18vw, 110px)
      clamp(76px, 18vw, 110px)
      clamp(36px, 8vw, 48px);
  }
  .legend{
    color:#c9d4df; text-transform:uppercase; font-size:13px; letter-spacing:.6px;
    border-bottom:1px solid var(--line); padding:0 6px 8px 6px; margin-bottom:8px;
  }
  .legend > div:nth-child(1){opacity:.85}
  .set-row{padding:8px 6px;border-bottom:1px solid var(--line)}
  .set-row:last-child{border-bottom:none}

  .set-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  input[type="number"], input[type="text"]{
    width:100%;background:#0e1319;border:1px solid var(--line);color:var(--ink);
    padding:10px;border-radius:10px;outline:none;font-size:16px
  }
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none;margin:0 }
  .setchk{display:flex;align-items:center;justify-content:center}
  .setchk input[type="checkbox"]{width:22px;height:22px}

  /* –û—á–µ–Ω—å —É–∑–∫–∏–µ —à–∏—Ä–∏–Ω—ã: –µ—â—ë –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ, –Ω–æ –±–µ–∑ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ */
  @media (max-width:380px){
    .legend, .set-row{
      grid-template-columns:
        auto
        clamp(70px, 22vw, 96px)
        clamp(70px, 22vw, 96px)
        clamp(32px, 10vw, 42px);
    }
  }

  .sumline{display:flex;gap:16px;flex-wrap:wrap;align-items:center;color:var(--muted);padding:12px 14px;border-top:1px dashed var(--line)}
  footer{margin:14px 0 10px calc(18px + var(--s-left));color:var(--muted)}
</style>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => navigator.serviceWorker.register('./service-worker.js'));
  }
</script>
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <h1>BOND HEAVY DUTY ‚Äî —Å–∏–ª–æ–≤—ã–µ –¥–Ω–∏</h1>
      <div class="sub">HIT: 1 —Ä–∞–∑–º–∏–Ω–æ—á–Ω—ã–π + 1 —Ä–∞–±–æ—á–∏–π —Å–µ—Ç –¥–æ –æ—Ç–∫–∞–∑–∞ ‚Ä¢ —Ç–µ–º–ø 4—Å –≤–≤–µ—Ä—Ö / 4—Å –≤–Ω–∏–∑ ‚Ä¢ –æ—Ñ–ª–∞–π–Ω + –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</div>

      <div class="toolbar">
        <div><span class="muted">–î–∞—Ç–∞:</span> <input id="logDate" type="date" aria-label="–î–∞—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏"></div>
        <div class="btn" id="exportBtn" role="button">–≠–∫—Å–ø–æ—Ä—Ç JSON</div>
        <label class="btn" role="button" aria-label="–ò–º–ø–æ—Ä—Ç JSON">
          –ò–º–ø–æ—Ä—Ç JSON
          <input id="importInput" type="file" accept="application/json" style="display:none">
        </label>
        <div class="btn warn" id="copyDayBtn" role="button">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—à–ª—ã–µ –≤–µ—Å–∞</div>
        <div class="btn danger" id="resetBtn" role="button">–°–±—Ä–æ—Å —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è</div>
        <div class="btn ok" role="button" onclick="window.print()">–ü–µ—á–∞—Ç—å</div>
      </div>

      <div class="tabs" role="tablist">
        <div class="tab active" data-day="upper" role="tab" aria-selected="true">–î–µ–Ω—å 1 ‚Äî –í–µ—Ä—Ö</div>
        <div class="tab" data-day="lower" role="tab" aria-selected="false">–î–µ–Ω—å 2 ‚Äî –ù–∏–∑ + –ö–æ—Ä</div>
      </div>
    </div>
  </header>

  <main>
    <!-- ===== –î–ï–ù–¨ 1 ===== -->
    <section id="upper" class="day active" aria-labelledby="tab-upper">
      <div class="block">
        <header>
          <div><strong>–í–µ—Ä—Ö —Ç–µ–ª–∞</strong> <span class="tag">HIT</span></div>
          <div class="muted">–û—Ç–¥—ã—Ö 60‚Äì120 —Å</div>
        </header>

        <div class="exercises">
          <!-- –ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –Ω–∞–∫–ª–æ–Ω -->
          <div class="panel" data-ex="upper_press_incline">
            <div class="ex-title">1Ô∏è‚É£ –ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ø–æ–¥ —É–≥–ª–æ–º (15‚Äì30¬∞) <small>—Ü–µ–ª—å: 6‚Äì8 –¥–æ –æ—Ç–∫–∞–∑–∞</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="0.5">
              <input data-r type="number" min="1" max="12">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="0.5" value="20">
              <input data-r type="number" min="1" max="12" value="7">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <!-- –¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ / –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è -->
          <div class="panel" data-ex="upper_latpull_pullups">
            <div class="ex-title">2Ô∏è‚É£ –¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞ / –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è <small>—Ü–µ–ª—å: 8‚Äì10</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å/–≤–∞—Ä–∏–∞–Ω—Ç</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="text" value="–±–ª–æ–∫ 30">
              <input data-r type="number" min="1" max="20" value="10">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="text" value="–±–ª–æ–∫ 40 / –ø–æ–¥—Ç—è–≥. —Å–≤.–≤–µ—Å">
              <input data-r type="number" min="1" max="20" value="9">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <!-- –ñ–∏–º —Ç—Ä–µ–Ω–∞–∂–µ—Ä –≥—Ä—É–¥—å -->
          <div class="panel" data-ex="upper_chest_machine">
            <div class="ex-title">3Ô∏è‚É£ –ñ–∏–º —Ç—Ä–µ–Ω–∞–∂—ë—Ä (–≥—Ä—É–¥—å) <small>—Ü–µ–ª—å: 6‚Äì8</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="5" value="55">
              <input data-r type="number" value="10">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="5" value="65">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <!-- –¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–æ—Å–∞ -->
          <div class="panel" data-ex="upper_row_cable">
            <div class="ex-title">4Ô∏è‚É£ –¢—è–≥–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–æ—Å–∞ <small>—Ü–µ–ª—å: 8‚Äì10</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="5" value="45">
              <input data-r type="number" value="10">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="5" value="55">
              <input data-r type="number" value="9">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <!-- –ê—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π -->
          <div class="panel" data-ex="upper_shoulder_dbpress">
            <div class="ex-title">5Ô∏è‚É£ –ê—Ä–º–µ–π—Å–∫–∏–π –∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π <small>—Ü–µ–ª—å: 6‚Äì8</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="0.5" value="12.5">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="0.5" value="15">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <!-- –¢—Ä–∏—Ü–µ–ø—Å —Ç—Ä–æ—Å -->
          <div class="panel" data-ex="upper_triceps_rope">
            <div class="ex-title">6Ô∏è‚É£ –¢—Ä–∏—Ü–µ–ø—Å —Ç—Ä–æ—Å (–≤–µ—Ä—ë–≤–∫–∞) <small>—Ü–µ–ª—å: 10‚Äì12</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="2.5" value="20">
              <input data-r type="number" value="10">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="2.5" value="25">
              <input data-r type="number" value="11">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <!-- –ë–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∞ -->
          <div class="panel" data-ex="upper_biceps_bar">
            <div class="ex-title">7Ô∏è‚É£ –ë–∏—Ü–µ–ø—Å —à—Ç–∞–Ω–≥–∞ (EZ) <small>—Ü–µ–ª—å: 8‚Äì10</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="2.5" value="15">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="2.5" value="20">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>
        </div>

        <div class="sumline">
          <span>üíæ –û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º –∏ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</span>
          <span id="upperDone" class="tag">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: 0 —Å–µ—Ç–æ–≤</span>
        </div>
      </div>
    </section>

    <!-- ===== –î–ï–ù–¨ 2 ===== -->
    <section id="lower" class="day" aria-labelledby="tab-lower">
      <div class="block">
        <header>
          <div><strong>–ù–∏–∑ + –∫–æ—Ä–ø—É—Å</strong> <span class="tag">HIT</span></div>
          <div class="muted">–û—Ç–¥—ã—Ö 90‚Äì120 —Å</div>
        </header>

        <div class="exercises">
          <div class="panel" data-ex="lower_squat_legpress">
            <div class="ex-title">1Ô∏è‚É£ –ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π / –∂–∏–º –Ω–æ–≥–∞–º–∏ <small>—Ü–µ–ª—å: 8‚Äì10</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="2.5" value="30">
              <input data-r type="number" value="10">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="2.5" value="40">
              <input data-r type="number" value="10">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <div class="panel" data-ex="lower_rdl">
            <div class="ex-title">2Ô∏è‚É£ –†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞ <small>—Ü–µ–ª—å: 8</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="2.5" value="25">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="2.5" value="35">
              <input data-r type="number" value="8">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <div class="panel" data-ex="lower_calves">
            <div class="ex-title">3Ô∏è‚É£ –ü–æ–¥—ä—ë–º –Ω–∞ –Ω–æ—Å–∫–∏ (–∏–∫—Ä—ã) <small>—Ü–µ–ª—å: 15‚Äì20</small></div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å</div><div>–ü–æ–≤—Ç–æ—Ä—ã</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–†–∞–∑–º–∏–Ω–∫–∞</div>
              <input data-w type="number" step="2.5" value="20">
              <input data-r type="number" value="12">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–†–∞–±–æ—á–∏–π</div>
              <input data-w type="number" step="2.5" value="30">
              <input data-r type="number" value="16">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>

          <div class="panel" data-ex="lower_core_plank">
            <div class="ex-title">4Ô∏è‚É£ –ö–æ—Ä: –ø–ª–∞–Ω–∫–∞ + –≤–∞–∫—É—É–º</div>
            <div class="legend"><div>–°–µ—Ç</div><div>–í–µ—Å/—Å–µ–∫</div><div>–ü–æ–≤—Ç–æ—Ä—ã/—Å–µ–∫</div><div>–í—ã–ø.</div></div>
            <div class="set-row">
              <div class="set-name">–ü–ª–∞–Ω–∫–∞</div>
              <input data-w type="text" value="—Å–≤. –≤–µ—Å">
              <input data-r type="text" value="45 —Å–µ–∫">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
            <div class="set-row">
              <div class="set-name">–í–∞–∫—É—É–º</div>
              <input data-w type="text" value="–¥—ã—Ö–∞–Ω–∏–µ">
              <input data-r type="text" value="3√ó10 —Å–µ–∫">
              <label class="setchk"><input data-d type="checkbox"></label>
            </div>
          </div>
        </div>

        <div class="sumline">
          <span>üíæ –û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º –∏ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</span>
          <span id="lowerDone" class="tag">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: 0 —Å–µ—Ç–æ–≤</span>
        </div>
      </div>
    </section>
  </main>

  <footer>
    –¢–µ–º–ø: 4—Å –≤–≤–µ—Ä—Ö / 4—Å –≤–Ω–∏–∑ ‚Ä¢ –î–æ—Å—Ç–∏–≥ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –ø–æ–≤—Ç–æ—Ä–æ–≤ ‚Üí —É–≤–µ–ª–∏—á—å –≤–µ—Å –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑
  </footer>

<script>
(function(){
  const VERSION = 'v5'; // –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º
  const tabs = document.querySelectorAll('.tab');
  const days = document.querySelectorAll('.day');
  const logDate = document.getElementById('logDate');
  const exportBtn = document.getElementById('exportBtn');
  const importInput = document.getElementById('importInput');
  const resetBtn = document.getElementById('resetBtn');
  const copyDayBtn = document.getElementById('copyDayBtn');

  function activeDayId(){ return document.querySelector('.tab.active').dataset.day }
  function storeKey(day, date){ return `bondHD.${VERSION}.${day}.${date}` }
  function lastKey(day){ return `bondHD.${VERSION}.${day}.LAST` }
  function todayISO(){
    const d = new Date(); const off = d.getTimezoneOffset();
    return new Date(d.getTime()-off*60000).toISOString().slice(0,10);
  }
  logDate.value = todayISO();

  tabs.forEach(t=>{
    t.addEventListener('click', ()=>{
      tabs.forEach(x=>{x.classList.remove('active'); x.setAttribute('aria-selected','false')});
      t.classList.add('active'); t.setAttribute('aria-selected','true');
      days.forEach(d=>d.classList.remove('active'));
      document.getElementById(t.dataset.day).classList.add('active');
      loadForDate(); updateCounters();
    });
  });

  // ==== —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ ====
  function readForm(day){
    const root = document.getElementById(day);
    const panels = root.querySelectorAll('.panel[data-ex]');
    const data = {};
    panels.forEach(p=>{
      const ex = p.getAttribute('data-ex');
      const rows = p.querySelectorAll('.set-row');
      data[ex] = [];
      rows.forEach(r=>{
        data[ex].push({
          set: r.querySelector('.set-name')?.textContent.trim() ?? '',
          weight: r.querySelector('[data-w]')?.value ?? '',
          reps: r.querySelector('[data-r]')?.value ?? '',
          done:  !!r.querySelector('[data-d]')?.checked
        });
      });
    });
    return data;
  }

  function writeForm(day, data){
    if(!data) return;
    const root = document.getElementById(day);
    const panels = root.querySelectorAll('.panel[data-ex]');
    panels.forEach(p=>{
      const ex = p.getAttribute('data-ex');
      const rows = p.querySelectorAll('.set-row');
      const arr = data[ex] || [];
      rows.forEach((r,i)=>{
        const item = arr[i]; if(!item) return;
        const w = r.querySelector('[data-w]'); if(w) w.value = item.weight ?? '';
        const rr = r.querySelector('[data-r]'); if(rr) rr.value = item.reps ?? '';
        const ch = r.querySelector('[data-d]'); if(ch) ch.checked = !!item.done;
      });
    });
  }

  function saveForDate(){
    const day = activeDayId();
    const date = logDate.value || todayISO();
    const data = readForm(day);
    localStorage.setItem(storeKey(day,date), JSON.stringify(data));
    localStorage.setItem(lastKey(day), JSON.stringify(data));
    updateCounters();
  }

  function loadForDate(){
    const day = activeDayId();
    const date = logDate.value || todayISO();
    const raw = localStorage.getItem(storeKey(day,date));
    if(raw){ writeForm(day, JSON.parse(raw)); }
    else {
      const last = localStorage.getItem(lastKey(day));
      if(last){
        const data = JSON.parse(last);
        Object.keys(data).forEach(ex=>data[ex].forEach(s=>s.done=false));
        writeForm(day,data);
      } else {
        document.querySelectorAll('#'+day+' [data-d]').forEach(c=>c.checked=false);
      }
    }
  }

  document.body.addEventListener('input', e=>{ if(e.target.matches('input')) saveForDate(); });
  document.body.addEventListener('change', e=>{
    if(e.target.matches('input[type="checkbox"], input[type="date"]')) {
      if(e.target.type==='date') loadForDate();
      saveForDate();
    }
  });

  exportBtn.addEventListener('click', ()=>{
    const all = {};
    for(let i=0;i<localStorage.length;i++){
      const k = localStorage.key(i);
      if(k && k.startsWith('bondHD.')) all[k] = localStorage.getItem(k);
    }
    const blob = new Blob([JSON.stringify(all,null,2)], {type:'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `bond_hd_export_${todayISO()}.json`;
    a.click(); URL.revokeObjectURL(a.href);
  });

  importInput.addEventListener('change', async (e)=>{
    const file = e.target.files[0]; if(!file) return;
    const text = await file.text(); const obj = JSON.parse(text);
    Object.keys(obj).forEach(k=>{ if(k.startsWith('bondHD.')) localStorage.setItem(k, obj[k]); });
    loadForDate(); updateCounters(); importInput.value='';
  });

  copyDayBtn.addEventListener('click', ()=>{
    const day = activeDayId(); const date = logDate.value || todayISO();
    const keys = Object.keys(localStorage).filter(k=>k.startsWith(`bondHD.${VERSION}.${day}.20`));
    const prev = keys.filter(k=>k.split('.').pop() < date).sort().pop();
    if(prev){
      const data = JSON.parse(localStorage.getItem(prev));
      Object.keys(data).forEach(ex=>data[ex].forEach(s=>s.done=false));
      writeForm(day,data); saveForDate();
    }
  });

  function updateCounters(){
    ['upper','lower'].forEach(id=>{
      const root = document.getElementById(id);
      const chk = root.querySelectorAll('[data-d]');
      let done = 0; chk.forEach(c=>{ if(c.checked) done++; });
      const el = document.getElementById(id==='upper' ? 'upperDone' : 'lowerDone');
      if(el){ el.textContent = `–í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${done} —Å–µ—Ç–æ–≤`; el.className = 'tag ' + (done>0?'oktag':''); }
    });
  }

  loadForDate(); updateCounters();
})();
</script>
</body>
</html>
